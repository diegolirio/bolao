<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script type="text/javascript">

	// Load the Visualization API and the piechart package.
    google.load('visualization', '1.0', {'packages':['corechart']});
	
	// Set a callback to run when the Google Visualization API is loaded.
	//google.setOnLoadCallback(drawChart);
	
    function drawChart(ap, ar, av, ae, as, er, qtde_jg) {
			// Create the data table.
			var data = new google.visualization.DataTable();
			data.addColumn('string', 'Critérios de Acertos');
			data.addColumn('number', 'Quantidade');
			
			data.addRows([
				['AP', ap], // Acertou Placar
				['AR', ar], // Acertou Vencedor e Resultado de Gols de um time
				['AV', av], // Acertou Vencedor
				['AE', ae], // Acertou Empate com placar diferente
				['AS', as], // Acertou somente o Resultado de Gols de um time.
				['ER', er]  // Errou Tudo
			]);
			
			// Set chart options
			var options = {'title': qtde_jg + ' Jogos',
						   'width':350,
						   'height':200,
						   is3D: true
						  };
			// Instantiate and draw our chart, passing in some options.
			var chart = new google.visualization.PieChart(document.getElementById('chart'));
			chart.draw(data, options);
    }

	function get_detail_participante(inscricao_pk) {
	
		$('#chart').html('<img src="/media/images/__159__.gif"/>	');
	    $('#title_modal').html('<img src="/media/images/159.gif" class="img-rounded"/> ');
	    $('#col_pt').html('<img src="/media/images/211.gif" class="img-rounded"/>');
	
		$.getJSON('/perfil_competicao_modal/'+inscricao_pk,  // URL 
		
				  function(retorno) {         // REQUISIÇÂO        	  				  
					//alert(JSON.stringify(retorno)); // Convert JSon para String				  
					html_ = '<h2>';
					html_ +=     '<a href="/perfil_competicao/{{competicao.id}}/'+retorno[0].fields.inscricao_id+'">  ';
					html_ +=     '    <img src="'+retorno[0].fields.participante_foto+'" height="50" width="55" class="img-rounded"/>'+retorno[0].fields.participante_apelido;
					html_ +=     '</a>';
					html_ += '</h2>';
					$('#title_modal').html(html_);
					
					$('#col_pt').html('<div><br/><br/><h4> '+retorno[0].fields.inscricao_colocacao+'º Colocado </h4><br/><h4> '+retorno[0].fields.inscricao_pontos+' pontos </h4></div>');				  				
					
					// ToDo...: Se nao for meu historico...
					//$('#id_href_compare').html('<a href="#" id="" title="compare as colocações">Compare as colocações</a>');
					
					drawChart(retorno[0].fields.inscricao_quantidade_acerto_placar, 
					          retorno[0].fields.inscricao_quantidade_acerto_vencedor_um_resultado_correto,
							  retorno[0].fields.inscricao_quantidade_acerto_vencedor,
							  retorno[0].fields.inscricao_quantidade_acerto_empate_erro_placar,
							  retorno[0].fields.inscricao_quantidade_acerto_somente_resultado_um_time, 
							  retorno[0].fields.inscricao_quantidade_erro,
							  retorno[0].fields.quantidade_jogos);
					
				  }           
		);  	
	}
	
	$(function() {
	
		get_one_puclicidade_pagina('K', {{competicao.id}});
	
		$('.id_col').mouseenter(function() {
			$('.id_col').addClass('btn');
		}).mouseleave(function() {
			$('.id_col').removeClass('btn');
		});
		
	});
	
</script>

<div class="row">

	<div class="visible-desktop pull-right" id="id_publicidade_top">
		<img src="/media/images/__159__.gif"/>
	</div>	
	
	<p>{{competicao.campeonato.nome}}</p>
	<h3>Copa <a href="{{patrocinador.patrocinador.url_site}}" target="_blank">{{patrocinador.patrocinador.nome_visual}}</a> {{competicao.nome}}</h3>
	{% if valor_acumulado != 0 %}
		<h5><span class="text-success">R$ </span> <span style="font-size: 20px;"> <b>{{ valor_acumulado }}</b> </span> <span class="">Acumulado</span></h3> 
	{% endif %}
	
	
	<br/>
	<!-- Modal Contato -->
	<div id="modal_contato" class="modal-ui hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
		<div class="modal-header">
			<button type="button" class="close" data-dismiss="modal" aria-hidden="true"><span class="text-warning">X</span></button>
			<h3>Contato</h3>
		</div>
		<div class="modal-body">
			<form action="/contato_email/" method="POST" class="form-horizontal"> {% csrf_token %}	
				<div id="legend">
				   <legend><h3>Email</h3></legend>
				</div>			
				<div class="control-group">
					<label class="control-label">Nome</label>										
					<div class="controls">
						<input type="text" name="nome" value="{{user_inscricao.participante.apelido}}">
						<!--
						{ if form.dono.errors } 
							{ for error in form.dono.errors }
								<span class="help-inline"><span class="text-error">{ error|escape }</span></span>
							{ endfor }
						{ endif } 																
						-->
					</div>	
				</div>			
				<div class="control-group">
					<label class="control-label">Email</label>										
					<div class="controls">
						<input type="text" name="email" value="{{user_inscricao.participante.user.email}}">
						<!--
						{ if form.dono.errors } 
							{ for error in form.dono.errors }
								<span class="help-inline"><span class="text-error">{ error|escape }</span></span>
							{ endfor }
						{ endif } 																
						-->
					</div>	
				</div>
				<div class="control-group">
					<label class="control-label">Telefone</label>										
					<div class="controls">
						<input type="text" name="telefone" value="{{user_inscricao.participante.dd}} {{user_inscricao.participante.telefone}}">
						<!--
						{ if form.dono.errors } 
							{ for error in form.dono.errors }
								<span class="help-inline"><span class="text-error">{ error|escape }</span></span>
							{ endfor }
						{ endif } 																
						-->
					</div>	
				</div>					
				<div class="control-group">
					<label class="control-label">Mensagem</label>										
					<div class="controls">
						<textarea id="message" name="message" class="span4" placeholder="Sua Mensagem" rows="5"></textarea>				
						<!--
						{ if form.dono.errors } 
							{ for error in form.dono.errors }
								<span class="help-inline"><span class="text-error">{ error|escape }</span></span>
							{ endfor }
						{ endif } 																
						-->
					</div>	
				</div>									
			</form>
		</div>
		<div class="modal-footer">
			<button type="submit" class="btn btn-danger"><i class="icon-ok"></i> Enviar </button>
			<a href="#" class="btn" type="button"><i class="icon-ban-circle"></i> Cancelar</a>				
		</div>
	</div>		
	<!-- Fim  Modal Contato -->
	
	{% if not user_inscricao.pagamento and competicao.valor_aposta > 0 and user_inscricao.id > 0 %}
		<div class="alert alert-block">
			<button type="button" class="close" data-dismiss="alert">&times;</button>
			<h2>Aviso!</h2>
			<h4>
				{{ competicao.mensagem_para_pagamento_pendente }}
				<a href="#modal_contato" role="button" onclick="" data-toggle="modal" class="alert-link"> Clique aqui</a> para entrar em contato.
			</h4>
		</div>	
	{% endif %}

	<!-- Modal Perfil -->
	<div id="modal_part" class="modal-ui hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
		<div class="modal-header">
			<button type="button" class="close" data-dismiss="modal" aria-hidden="true"><span class="text-warning">X</span></button>
			<div id="title_modal">
				<img src="/media/images/159.gif" class="img-rounded"/> 
			</div>
		</div>
		<div class="modal-body">
			<div id="content_modal">
					<div class="pull-right"><div id="chart"><img src="/media/images/__159__.gif"/></div></div>
					<div id="col_pt">
						<center><img src="/media/images/211.gif" class="img-rounded"/></center>
					</div>
					<br/>
					<center><div id="chart_line"></div></center>				
			</div>
		</div>
		<div class="modal-footer">
			<span id="id_href_compare"></span>
			<a href="#" id="id_href_hist" class="pull-left" title="compare as colocações">Clique aqui para ver histórico da colocação</a>
		</div>
	</div>	
	<!-- Fim Modal -->
	
	<div class="span10">
	
		<p class="pull-left"><a href="#"><a href="javascript:frame_impressao.print()">Imprimir</a></p>
        <iframe name='frame_impressao' id='frame_impressao' height='0' width='0' src='/imprimir_rancking/{{competicao.id}}/' frameborder=' '>
        </iframe>		
		
		{% include 'legenda_pontos.html' %}
		
		<!--% include 'rancking_table.html' %-->	

		<table class="table table-striped table-hover well">
			<tr>
				<td class="text-error">Col.</td>
				<td class="text-error">Participante</td>
				<td class="text-error">Insc.</td>
				<td class="text-error" title="Pontos"><center>Pontos</center></td>
				<td class="text-error" title="Acerto do Placar">AP</td>
				<td class="text-error" title="Acerto do Vencedor e quantidade de gols de um Time">AR</td>
				<td class="text-error" title="Acerto do Vencedor">AV</td>
				<td class="text-error" title="Acerto de Empate com placar diferente">AE</td>
				<td class="text-error" title="Acerto de Somente da quantidade de gols de um Time">AS</td>
				<td class="text-error" title="Acerto de Somente da quantidade de gols de um Time">ER</td>
			</tr>
			
			{% for ip in inscricoes_competicao %}
			
			{% if ip.participante.id == user_participante.id %}
				<h1>
			{% endif %}
			<tr>
				<td>
					<a href="/comparar_colocacao/{{competicao.id}}/{{ip.id}}/" class="text-info" target="_blank" title="Comparar colocação">
						{% if ip.participante.id == user_participante.id %}
							<h4>{{ ip.colocacao}}º</h4>
						{% else %}
							{{ ip.colocacao}}º
						{% endif %}
					</a>
				</td>
				<td> <!-- nome participante -->
					<a href="#modal_part" role="button" data-toggle="modal" onclick="get_detail_participante( {{ ip.id }} );" {% if ip.participante.id == user_participante.id %} class="text-warning" {% endif %}>
						{% if ip.participante.id == user_participante.id %}
							<h4>
						{% endif %}						
							<img src="/media/{{ ip.participante.foto }}" 
								{% if ip.participante.id == user_participante.id %}
								 height="30" width="37" class="img-rounded"/>
								{% else %}
								 height="20" width="25" class="img-rounded"/>
								{% endif %}
							{{ ip.participante }}
						{% if ip.participante.id == user_participante.id %}
							</h4>
						{% endif %}									
					</a>
					<!--
					<a href="/perfil_competicao/{{competicao.id}}/{{ip.id}}/" {% if ip.participante.id == user_participante.id %} class="text-warning" {% endif %}>
						<img src="/media/{{ ip.participante.foto }}" height="20" width="25" class="img-rounded"/>
						{{ ip.participante }}
					</a>
					-->
				</td>
				<td class="muted">
					{% if ip.participante.id == user_participante.id %}
						<h4>{{ ip.id }}</h4>
					{% else %}
						{{ ip.id }}
					{% endif %}
				</td>
				<td class="text-info"><center><b>
					{% if ip.participante.id == user_participante.id %}
						<h4>{{ ip.pontos }}</h4>
					{% else %}
						{{ ip.pontos }}
					{% endif %}										
				</b></center></td>
				<td class="muted">
					{% if ip.participante.id == user_participante.id %}
						<h4>{{ ip.quantidade_acerto_placar }}</h4>
					{% else %}
						{{ ip.quantidade_acerto_placar }}
					{% endif %}									
				</td>
				<td class="muted">
					{% if ip.participante.id == user_participante.id %}
						<h4>{{ ip.quantidade_acerto_vencedor_um_resultado_correto }}</h4>
					{% else %}
						{{ ip.quantidade_acerto_vencedor_um_resultado_correto }}
					{% endif %}												
				</td>
				<td class="muted">
					{% if ip.participante.id == user_participante.id %}
						<h4>{{ ip.quantidade_acerto_vencedor }}</h4>
					{% else %}
						{{ ip.quantidade_acerto_vencedor }}
					{% endif %}																	
				</td>
				<td class="muted">
					{% if ip.participante.id == user_participante.id %}
						<h4>{{ ip.quantidade_acerto_empate_erro_placar }}</h4>
					{% else %}
						{{ ip.quantidade_acerto_empate_erro_placar }}
					{% endif %}														
				</td>
				<td class="muted">
					{% if ip.participante.id == user_participante.id %}
						<h4>{{ ip.quantidade_acerto_somente_resultado_um_time }}</h4>
					{% else %}
						{{ ip.quantidade_acerto_somente_resultado_um_time }}
					{% endif %}																
				</td>
				<td class="muted">
					{% if ip.participante.id == user_participante.id %}
						<h4>{{ ip.quantidade_erro }}</h4>
					{% else %}
						{{ ip.quantidade_erro }}
					{% endif %}																					
				</td>
			</tr>
			{% empty %}
				<h2 class="muted">Não há participantes cadastrados</h2>
			{% endfor %}
		</table>
	</div>	
	<div class="span2">
	
		<h4> Alguma ideia revolucionaria aqui</h4>
		
		<br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/>
		<br/><br/><br/><br/><br/>
	
		<span class="text-warning">publicidade</span><br/>
		<div class="visible-desktop">
			<a href="{{ patrocinador.patrocinador.url_site }}" target="_blank">
				<img class="img-rounded" title="{{patrocinador.patrocinador.nome_visual}}" height="100" width="150" src="/media/{{ patrocinador.patrocinador.image_aside }}"/>
			</a>
			<br/><br/>
		</div>	
		
		{% for p in patrocinadores %}
			<div class="visible-desktop">
				<a href="{{ p.competicacao_patrocinador.patrocinador.url_site }}" target="_blank">
					<img class="img-rounded" title="{{p.competicacao_patrocinador.patrocinador.nome_visual}}" height="100" width="150" src="/media/{{ p.competicacao_patrocinador.patrocinador.image_aside }}"/>
				</a>
				<br/><br/>
			</div>			
		{% endfor %}
		
		<!--
		<div class="visible-desktop">
			<a href="http://www.asisco.com.br" target="_blank"><img class="img-rounded" src="/media/images/patrocinadores/cocacola.png"/></a>
			<br/><br/>
		</div>
		<div class="visible-desktop">
			<a href="http://www.asisco.com.br" target="_blank"><img class="img-rounded" src="/media/images/patrocinadores/asisco.jpg"/></a>
			<br/><br/>
		</div>
		-->
		<div class="patrocinador">
			<img class="img-rounded" height="100" width="150" src="/media/images/patrocinadores/anuncie.gif"/>
		</div>
	</div>
</div>
